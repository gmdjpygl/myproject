<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" ><head>   <title>Playvideo</title>    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />	<link rel="stylesheet" type="text/css" href="../images/pages.css" />    <script src="../../js/prototype/prototype.js" type="text/javascript"></script>     <script src="../../js/NPPInterface.js" type="text/javascript"></script>     <script src="../../js/NPPInterlayer.js" type="text/javascript"></script> 	<script src="../npp_examples_config.js" type="text/javascript"></script>		<style>		table,td,tr{			border:1px grey solid;		}		td{			width:250px;		}		.td_b{			color:blue;		}		input,button{ width:40px;margin-bottom:3px; height:22px;}	</style></head><body>	<div style="overflow:hidden;width:420px;border:0px red solid;">	<div style="float:left;">		<div id="windowbox" style="border:1px grey solid;width:352px;height:268px;margin-left:10px;"></div>		<div id="windowtitle" style="border-bottom:1px grey solid;border-left:1px grey solid;border-right:1px grey solid;width:352px;line-height:20px;height:20px;margin-left:10px;"></div>	</div>	<div style="float:left;margin-left:10px;">		<div><input type="button" value="关闭" onclick="javascript:WebClient.StopVideo();"/></div>		<div><input type="button" value="向上" onmousedown="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.turnup);" onmouseup="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.stopturn)"/></div>		<div><input type="button" value="向下" onmousedown="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.turndown);" onmouseup="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.stopturn)"/></div>		<div><input type="button" value="向左" onmousedown="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.turnleft);" onmouseup="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.stopturn)"/></div>		<div><input type="button" value="向右" onmousedown="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.turnright);" onmouseup="javascript:WebClient.PTZControl(NPPIF.Enum.PTZDirection.stopturn)"/></div>		<div><input type="button" value="抓拍" onclick="javascript:WebClient.SnapShot();"/></div>		<div><input type="button" value="录像" onclick="javascript:WebClient.Record();"/></div>		<div><input type="button" value="音频" onclick="javascript:WebClient.PlayAudio();"/></div>	</div>	</div>	<div style="border-bottom:1px grey solid;border-left:1px grey solid;border-right:1px grey solid;width:352px;line-height:20px;height:20px;margin-left:10px;text-overflow:ellipsis;overflow:hidden;">		<div id="loginMsg" style="float:left;"></div>		<div id="gpsMsg" style="float:left;" ></div>	</div>	<!-- <div id="loginMsg" style= "border-bottom:1px grey solid;border-left:1px grey solid;border-right:1px grey solid;width:352px;height:20px;margin-left:10px"></div> --></body></html><script>var winparent = typeof window.opener != "undefined" ? window.opener : (window.parent || null);var WebClient = {	connectId : null,	resource : new Hash(),	ResGPS: new Hash(),	wnd : null,	PageName : null,	//获取父页面传递过来的参数    GetRequest:function() {    var url = location.search; //获取url中"?"符后的字串    var theRequest = new Object();    if (url.indexOf("?") != -1) {       var str = url.substr(1);       strs = str.split("&");       for(var i = 0; i < strs.length; i ++) {         theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);       }     }     return theRequest;    },				Load:function(){			var Request = new Object();		Request = WebClient.GetRequest();		var puid,idx,type,name;		puid = Request['puid'];		idx = Request['idx'];		type = Request['type'];		name = Request['name'];		WebClient.PageName = Request['PageName'];				//WebClient.connectId = Request['connectId'];				//初始化插件		try{		if(!NPPILY.Plug.inited){			//开始初始化			var rv = NPPILY.Init(new NPPILY.Struct.InitParamStruct(false, null,null));			if(rv.rv != NrcapError.NRCAP_SUCCESS){				alert(NrcapError.Detail(rv.rv));			}			var path = _npc.connParams.path || "127.0.0.1:8866";			var username = _npc.connParams.username || "admin";			var password = _npc.connParams.password || "";			var epId = _npc.connParams.epId || "system";//登陆参数：企业id			var bfix = _npc.connParams.bfix || 0;						var param = new NPPIF.Struct.ConnParamStruct(path,username,epId,password,bfix);			var conn = NPPILY.Connect(param); //创建连接			if(conn.rv == NrcapError.NRCAP_SUCCESS){				WebClient.connectId = conn.response;//NPPILY.Connect接口返回的连接ID(string)			}else{				if($("loginMsg"))					$("loginMsg").innerHTML = NrcapError.Detail(conn.rv) + "</br>";			}					}		}		catch(e){			alert(e.name + ","+ e.message);			return false;		}				WebClient.PlayVideo(puid,idx,name) //播放视频	},	// - 创建连接,并记录在NPPILY.Connections中	/*Connect:function(){		var path = _npc.connParams.path || "127.0.0.1:8866";					var username = _npc.connParams.username || "admin";		var password = _npc.connParams.password || "";		var epId = _npc.connParams.epId || "system";//登陆参数：企业id		var bfix = _npc.connParams.bfix || 0;				var param = new NPPIF.Struct.ConnParamStruct(path,username,epId,password,bfix);		//alert(Object.toJSON(param));		var conn = NPPILY.Connect(param);		if(conn.rv == NrcapError.NRCAP_SUCCESS){			WebClient.connectId = conn.response;			WebClient.PlayVideo();		}else{			//alert(conn.rv);			if($("loginMsg"))				$("loginMsg").innerHTML += NrcapError.Detail(conn.rv) + "</br>";		}	},*/		/*		创建窗口以及播放：		connectId(string) 连接ID         containerOrId(dom element | dom id) 窗口插件容器或ID		windowType(NPPILY.Enum.WindowType) 窗口类型		windowAttachEvent(NPPILY.Struct.WindowEventStruct) 绑定窗口事件		customParams(object) 自定义参数		wnd 窗口对象		puid (string) 设备ID 		idx (string)  资源索引		streamType (string)	流类型	*/	PlayVideo:function(puid,idx,name){					if($("windowbox")){			var connectId = WebClient.connectId;			if(connectId && NPPILY.Connections.get(connectId)){							var windowAttachEvent = new NPPILY.Struct.WindowEventStruct();				windowAttachEvent.lbtn_click.status = true;				windowAttachEvent.lbtn_click.callback = function(){					$("loginMsg").innerHTML = "鼠标左键单击响应回调函数";					//alert("鼠标左键单击响应回调函数")				}				windowAttachEvent.select_rect.status = true;				windowAttachEvent.select_rect.callback = function(){					//alert("鼠标拉选响应回调函数")					$("loginMsg").innerHTML = "鼠标拉选响应回调函数";				}				windowAttachEvent.ptz_control.status = true;				//windowAttachEvent.ptz_control.callback = function(){}				windowAttachEvent.fsw_show.status = true;				windowAttachEvent.fsw_show.callback = function(){					//alert("窗口全屏后的回调函数")					$("loginMsg").innerHTML = "窗口全屏后的回调函数";				}				windowAttachEvent.fsw_hide.status = true;				windowAttachEvent.fsw_hide.callback = function(){					//alert("窗口全屏恢复后的回调函数")					$("loginMsg").innerHTML = "窗口全屏恢复后的回调函数";				}				windowAttachEvent.menu_command.status = true;				windowAttachEvent.menu_command.menu = [					{key:"snapshot",text:"本地抓图"},					{key:"record",text:"本地录像"},					{key:"playaudio",text:"播放音频"},					{key:"playupaudio",text:"开始喊话"},					{key:"playtalk",text:"开始对讲"},					{key:"startGPS",text:"打开GPS"},					{key:"-",text:"split"},					{key:"fullscreen",text:"全屏"}				]				windowAttachEvent.menu_command.callback = function(key){					switch(key){						case "snapshot":							WebClient.SnapShot();							break;						case "record":							WebClient.Record();							break;						case "playaudio":							WebClient.PlayAudio();							break;						case "playupaudio"	:							WebClient.PlayUpAudio();							break;						case "playtalk"	:							WebClient.PlayTalk();							break;								case "startGPS" :							WebClient.StartGPS();							break;								case "fullscreen":								WebClient.FullScreen();							break;						}				}									// - 创建窗口				/*					"windowbox":containerOrId(dom element | dom id) 窗口插件容器或ID;					"REALTIME" :windowType(NPPILY.Enum.WindowType) 窗口类型;				*/				var windowObj = NPPILY.CreateWindow(connectId, "windowbox", "REALTIME", windowAttachEvent);				// - 返回窗口结构				var wnd = windowObj.response;								wnd.customParams.ivName = name;				wnd.customParams.FullScreenValue = "fullscreen";				wnd.customParams.gpsstatus = "start";				wnd.customParams.upaudio = "start";				wnd.customParams.talk = "start";				wnd.status.calling = false;				wnd.status.talking = false;				WebClient.wnd = wnd;				// - 播放视频				//"REALTIME": streamType (string)	流类型				var operator = NPPILY.PlayVideo(connectId,wnd,puid,idx,"REALTIME");								if(operator.rv == NrcapError.NRCAP_SUCCESS){									WebClient.GetWindowStatus(); //绑定事件									}else{					alert("播放失败="+operator.rv);				}			}			}	},	/*		-停止视频		wnd 窗口对象		containerId:containerOrId(dom element | dom id) 窗口插件容器或ID	*/	StopVideo:function(){		if($("windowbox")){			if(WebClient.wnd !=null){				var wnd = WebClient.wnd;				if(wnd.containerId == "windowbox"){					if(wnd.status.playvideoing){						var rvstop = NPPILY.StopVideo(wnd);						wnd.wnd.style.height = "0px"						wnd.wnd.style.width = "0px"						$("windowbox").innerHTML = "";						$("windowtitle").innerHTML="";						winparent.WebClient.Windowopen.unset(WebClient.PageName);						//winparent.WebClient.childwindow = "";						window.close();					}				}			}					}	},		GetWindowStatus:function(){		/*绑定事件			eventName:NPPILY.Enum.NCObjectNotify.stream_status_notify 绑定事件的名称			callback:WebClient.SetStatus 回调函数		*/		NPPILY.NCNotifyManager.Add(NPPILY.Enum.NCObjectNotify.stream_status_notify,WebClient.SetStatus);			},	/*绑定事件回调函数	  wnd 窗口对象	  args：回调的事件信息	*/	SetStatus:function(args){			if(typeof args == "object"){			var html1 = "",html2 = "",htmlstr = "";			var wnd = WebClient.wnd;			if(args.errorCode == NrcapError.NRCAP_SUCCESS){				switch(Number(args.status)){//-1表示流已断开，0表示正在缓冲，1表示正在播放,2表示正在下载，3表示下载完成				case -1:					html1 = "流已断开"					break;				case 0:					html1 = "正在缓冲"					break;				case 1:					html1 = "正在播放"					break;				case 2:					html1 = "正在下载"					break;				case 3:					html1 = "下载完成"					break;				}				var _bite = function(bite){					return (bite / 1000).toFixed(0) + "KB/s"; 				}				var bitrate = args.keyData.bit_rate;				var bite = _bite(bitrate)				var framerate = args.keyData.frame_rate;				var frame = framerate;				var wnd = WebClient.wnd;				var recStr = "";				if(wnd.status.recording){					recStr = "正在录像"				}else{					recStr = "";				}				var audStr = "";				if(wnd.status.playaudioing){					audStr = "正在播放声音"				}else{					audStr = "";				}				var upaudStr = "";				if(wnd.status.calling){					upaudStr = "正在喊话"				}else{					upaudStr = "";				}				var talkStr = "";				if(wnd.status.talking){					talkStr = "正在对讲"				}else{					talkStr = "";				}								html2 = "帧率："+frame+"，码率："+bite;				if(args._HANDLE == wnd.params.ivStreamHandle){					$("windowtitle").innerHTML = wnd.customParams.ivName+","+ html1 +","+ html2+","+ recStr+","+audStr+","+upaudStr+","+talkStr;					$("windowtitle").title = wnd.customParams.ivName+","+ html1 +","+ recStr+","+audStr+","+upaudStr+","+talkStr;				}			}			else{				html1 = "播放失败";			}		}	},	/*gps*/	StartGPS:function(){		var connectId = WebClient.connectId;		var wnd = WebClient.wnd;		if(typeof wnd != "object"){			return false;		}		var puid = wnd.params.puid;		var rv = NPPILY.ForkResource(connectId,NPPILY.Enum.ForkResourceLevel.nppForkPUResourceInfo,0,200,null,{PUID:puid});		var re = rv.response;		for (var i = 0; i < re.length; i++) {			var childRes = re[i];			if(childRes.type == NPPILY.Enum.PuResourceType.GPS){				WebClient.ResGPS.set(puid, {connectId:connectId, puid: puid, gpsIndex : childRes.idx, windowKey: "", flag: false });			}		}		var Gflag = false;		WebClient.ResGPS.each(function(item){			//alert(item.value.puid +",,"+ wnd.params.puid)			if(item.value.puid == wnd.params.puid){				Gflag = true;				//alert(wnd.customParams.gpsstatus)				if(wnd.customParams.gpsstatus == "start"){					var rv = NPPILY.StartGPSStream(connectId,item.value.puid,item.value.gpsIndex);					//alert(rv.rv)					if(rv.rv == NrcapError.NRCAP_SUCCESS){						//alert(333)						$("gpsMsg").innerHTML = "gps状态:";						wnd.customParams.gpsstatus = "end";						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"startGPS",text:"关闭GPS"}]);						NPPILY.NCNotifyManager.Add(NPPILY.Enum.NCObjectNotify.gps_data_notify,WebClient.SetGPSStatus);					}				}else{					var rv = NPPILY.StopGPSStream(connectId,item.value.puid,item.value.gpsIndex);					if(rv.rv == NrcapError.NRCAP_SUCCESS){						$("gpsMsg").innerHTML = "";						WebClient.ResGPS.unset(puid);						wnd.customParams.gpsstatus = "start";						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"startGPS",text:"打开GPS"}]);											}				}			}		});	},	/*绑定gps回调函数*/	SetGPSStatus:function(_data){		if(typeof _data == "object"){			if(_data.errorCode == NrcapError.NRCAP_SUCCESS){				switch(Number(_data.keyData.gps_status)){//GPS状态,0表示正常,1表示无信号,2表示无模块					case 0:						html3 = "正常";						break;					case 1:						html3 =	"无信号";						break;					case 2:						html3 ="无模块";						break;				}				var latitude = "纬度:"+_data.keyData.latitude;				var speed = "速度:"+_data.keyData.speed;				var gpsStr ="gps状态:"+html3;				$("gpsMsg").innerHTML = gpsStr+","+latitude+","+speed;				$("gpsMsg").title =  gpsStr+","+latitude+","+speed;			}				}	},	/*		-播放/停止音频		wnd 窗口对象		containerId:containerOrId(dom element | dom id) 窗口插件容器或ID	*/	PlayAudio:function(){		if($("windowbox")){			var wnd = WebClient.wnd;			if(wnd.containerId == "windowbox"){				if(wnd.status.playvideoing){					var paStop = NPPILY.PlayAudio(wnd);					alert(paStop.rv)					alert(Object.toJSON(NrcapError))					if(wnd.status.playaudioing){											NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playaudio",text:"停止音频"}]);					}else{						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playaudio",text:"播放音频"}]);					}				}			}		}	},	//对讲	PlayTalk:function(){		if($("windowbox")){			var wnd = WebClient.wnd;			var puid = wnd.params.puid;			if(wnd.customParams.talk == "start"){				if(wnd.status.calling){					var rv = NPPILY.CallTalkControl.Stop(WebClient.connectId,wnd.params.puid,WebClient.resOAIndex);					if(rv.rv == NrcapError.NRCAP_SUCCESS){						wnd.status.calling = false;						wnd.customParams.upaudio = "start";						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playupaudio",text:"开始喊话"}]);					}				}				var rv_arr = WebClient.CheckTalkEnable(puid) || [-1, -1];				switch (rv_arr[0]) {					case -1:						alert("设备不支持对讲！");						return false;						break;					case 0:						alert("资源已被占用，无法开启对讲！");						return false;						break;					default: // =>1						break;				}				var resOAIdx = rv_arr[1];				var rv = NPPILY.CallTalkControl.StartTalk(WebClient.connectId,puid,resOAIdx); // 开始对讲				if(rv.rv == NrcapError.NRCAP_SUCCESS){					wnd.status.talking = true;					wnd.customParams.talk = "end";					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playtalk",text:"停止对讲"}]);				}			}else{				var rv = NPPILY.CallTalkControl.Stop(WebClient.connectId,wnd.params.puid,WebClient.resOAIndex);				if(rv.rv == NrcapError.NRCAP_SUCCESS){					wnd.status.talking = false;					wnd.customParams.talk = "start";					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playtalk",text:"开始对讲"}]);				}			}		}	},	//喊话	PlayUpAudio:function(){				if($("windowbox")){			var wnd = WebClient.wnd;			var puid = wnd.params.puid;			if(wnd.customParams.upaudio == "start"){				if(wnd.status.talking){					var rv = NPPILY.CallTalkControl.Stop(WebClient.connectId,wnd.params.puid,WebClient.resOAIndex);					if(rv.rv == NrcapError.NRCAP_SUCCESS){						wnd.status.talking = false;						wnd.customParams.talk = "start";						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playtalk",text:"开始对讲"}]);					}				}								var rv_arr = WebClient.CheckTalkEnable(puid) || [-1, -1];				switch (rv_arr[0]) {					case -1:						alert("设备不支持对讲！");						return false;						break;					case 0:						alert("资源已被占用，无法开启对讲！");						return false;						break;					default: // =>1						break;				}				var resOAIdx = rv_arr[1];				var rv = NPPILY.CallTalkControl.StartCall(WebClient.connectId,puid,resOAIdx); // 开始对讲				//console.log($.toJSON(wnd.status))				if(rv.rv == NrcapError.NRCAP_SUCCESS){					wnd.status.calling = true;					wnd.customParams.upaudio = "end";				}				if(wnd.status.calling){					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playupaudio",text:"停止喊话"}]);				}else{					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playupaudio",text:"开始喊话"}]);				}			}else{					var rv = NPPILY.CallTalkControl.Stop(WebClient.connectId,wnd.params.puid,WebClient.resOAIndex);				if(rv.rv == NrcapError.NRCAP_SUCCESS){					wnd.status.calling = false;					wnd.customParams.upaudio = "start";				}				if(wnd.status.calling){					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playupaudio",text:"停止喊话"}]);				}else{					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"playupaudio",text:"开始喊话"}]);				}			}		}	},		ResOAChannels: new NPPUtils.Hash(),	resOAIndex:0,				CheckTalkEnable:function (puid) {		var rv = NPPILY.ForkResource(WebClient.connectId,NPPILY.Enum.ForkResourceLevel.nppForkPUResourceInfo,0,200,null,{PUID:puid});		var re = rv.response;		for (var i = 0; i < re.length; i++) {			var childRes = re[i];			if(childRes.type == NPPILY.Enum.PuResourceType.AudioOut){				WebClient.ResOAChannels.set(puid + "_" + childRes.idx, { puid: puid, index: childRes.idx, windowKey: "", flag: false });			}		}			var found = false, activeResOAIdx = 0, flag = -1;		WebClient.ResOAChannels.each			(				function (ee) {					var e = ee.value;					if (e.puid == puid) {						flag = 0; // 存在OA资源						if (found == false && e.flag != true) {							activeResOAIdx = e.index;							found = true;						}					}				}			);		if (found == true){flag = 1}		WebClient.resOAIndex = activeResOAIdx;		return [flag, activeResOAIdx];		// flag -1(不支持)， 0（被占用），1（可用）	},		/*		-视频抓拍		wnd 窗口对象		containerId:containerOrId(dom element | dom id) 窗口插件容器或ID		path：抓拍图片的存储路径	*/	SnapShot:function(){		var path = "C:/";		var wnd = WebClient.wnd;		if(typeof wnd != "object"){			return false;		}		if(wnd.containerId == "windowbox"){			if(wnd.status.playvideoing){				var paStop = NPPILY.Snapshot(wnd,path);			}		}	},	/*		-播放/停止录像		wnd 窗口对象		containerId:containerOrId(dom element | dom id) 窗口插件容器或ID	*/	Record:function(){		var path = "C://测试";		var wnd = WebClient.wnd;		if(typeof wnd != "object"){			return false;		}				if(wnd.containerId == "windowbox"){			if(wnd.status.playvideoing){				var rv = NPPILY.LocalRecord(wnd,"d:/","网页NPP-WebClient测试.avi" );				if(wnd.status.recording){					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"record",text:"停止录像"}]);				}				else{					NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"record",text:"本地录像"}]);				}			}		}	},	/*		-云台控制		connectId(string) 连接ID		puid (string) 设备ID 		idx (string)  资源索引		mode(NPPILY.Enum.PTZDirection)云台控制命令			*/	PTZControl:function(mode){		var wnd = WebClient.wnd;		if(typeof wnd != "object"){			return false;		}		var connectId = WebClient.connectId;		if(!connectId && !NPPILY.Connections.get(connectId)){			return false;		}		if(wnd.containerId == "windowbox"){			if(wnd.status.playvideoing){				var puid = wnd.params.puid || "";				var idx = wnd.params.idx || "";				var mode = mode || "";				//alert(puid+","+ idx+","+ mode)				var operator = NPPILY.PTZ.Control(connectId, puid, idx, mode);								if(operator.rv != NrcapError.NRCAP_SUCCESS){					alert("操作云台失败");				}			}		}	},	/*		-打开（NPPILY.FullScreen）/关闭全屏（NPPILY.ExitFullScreen）		wnd 窗口对象		containerId:containerOrId(dom element | dom id) 窗口插件容器或ID		path：抓拍图片的存储路径	*/	FullScreen:function(){		var wnd = WebClient.wnd;		if(typeof wnd != "object"){			return false;		}		if(wnd.containerId == "windowbox"){			if(wnd.status.playvideoing){				if(wnd.customParams.FullScreenValue == "fullscreen"){					var paStop = NPPILY.FullScreen(wnd);					if(paStop.rv == 0){						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"fullscreen",text:"退出全屏"}]);						wnd.customParams.FullScreenValue = "exitfullscreen";					}				}				else{					var paStop = NPPILY.ExitFullScreen(wnd);					if(paStop.rv == 0){						NPPILY.WindowAttachEvent.UpdateMenuCommand(wnd, [{key:"fullscreen",text:"全屏"}]);						wnd.customParams.FullScreenValue = "fullscreen";					}				}			}		}	},	//卸载插件	UnLoad:function(){		if($("windowbox")){			if(WebClient.wnd !=null){				var wnd = WebClient.wnd;				if(wnd.containerId == "windowbox"){					if(wnd.status.playvideoing){						var rvstop = NPPILY.StopVideo(wnd);						wnd.wnd.style.height = "0px"						wnd.wnd.style.width = "0px"						$("windowbox").innerHTML = "";						$("windowtitle").innerHTML="";						winparent.WebClient.Windowopen.unset(WebClient.PageName);						//winparent.WebClient.childwindow = "";					}				}			}		}		NPPILY.UnLoad();	},	end:true}	if(window.attachEvent){	window.attachEvent(		"onload",		function() {			if(WebClient && typeof WebClient == "object" && typeof WebClient.Load == "function") {				WebClient.Load(); 							}  		} 	);	window.attachEvent(		"onunload",		function(){			if(WebClient && typeof WebClient == "object" && typeof WebClient.UnLoad == "function") {						WebClient.UnLoad(); 							}  		}	);	window.attachEvent(		"onbeforeunload",		function(){					if(WebClient && typeof WebClient == "object" && typeof WebClient.UnLoad == "function") {							WebClient.UnLoad();			}  		}	);}else{	window.addEventListener (        "load",        function() {            if (WebClient && typeof WebClient == "object" && typeof WebClient.Load == "function") {                WebClient.Load();            }         },        false    );	window.addEventListener (        "unload",        function() {            if (WebClient && typeof WebClient == "object" && typeof WebClient.UnLoad == "function") {                WebClient.UnLoad();            }         },        false    );	window.addEventListener (        "beforeunload",        function() {            if (WebClient && typeof WebClient == "object" && typeof WebClient.UnLoad == "function") {                WebClient.UnLoad();            }         },        false    );}</script>